{"version":3,"sources":["cue_list/core.cljs"],"mappings":"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","names":["cue-list.core/pdfjs","cue_list.core.goog$module$goog$object.get","js/window","js/cue-list","js/cue-list.core","js/cue-list.core.state","cue-list.core/state","reagent.core.atom","cue-list.core/dom-point-vec","point","cue-list.core/viewport-point-to-doc-point","v-point","viewport","trans-mat","js/DOMMatrix","js/DOMPoint","cljs.core.nth","cue-list.core/doc-point-to-view-point","doc-point","cue-list.core/cue-flag-points","origin","cljs.core/first","cljs.core/second","cue-list.core/on-canvas-click","event","rect","vp-x","vp-y","js/Window","last-cue","or__5045__auto__","cljs.core/last","cljs.core.sort_by","cljs.core/deref","new-cue","cljs.core.swap_BANG_","cljs.core/assoc","cljs.core.conj","cue-list.core/sorted-cues","cues","p1__19706#","p1__19707#","cljs.core/reverse","cue-list.core/render-cue-flags","context","seq__19709","cljs.core/seq","chunk__19710","count__19711","i__19712","temp__5804__auto__","cljs.core/chunked-seq?","c__5568__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","cljs.core/next","cue","p1__19708#","cljs.core.filter","cljs.core._EQ_","flag-points","selected","cue-list.core/update-doc-dims","width","height","p__19713","map__19714","cljs.core/--destructure-map","cljs.core.get","cue-list.core/pdf-canvas","url","state","canvas-ref","js/module$node_modules$react$index.useRef","js/module$node_modules$react$index.useEffect","pdf","page","canvas","render-context","js/console.log","p__19715","map__19716","cue-list.core/cue-overlay","doc-canvas","js/document","cue-list.core/dec-page","p1__19717#","cljs.core.update","cljs.core/dec","cue-list.core/inc-page","p1__19718#","cljs.core/inc","cue-list.core/dec-zoom","p1__19719#","i","cue-list.core/inc-zoom","p1__19720#","cue-list.core/rotate-clockwise","p1__19721#","cljs.core/mod","cue-list.core/rotate-counterclockwise","p1__19722#","cue-list.core/on-cue-click","cue-list.core/remove-cue","cljs.core/vec","p1__19723#","cljs.core.not_EQ_","cue-list.core/update-cue-field","kw","val","idx","cljs.core.assoc","cue-list.core/cue-button-li","p1__19724#","p1__19725#","p1__19726#","p1__19727#","G__19729","fexpr__19728","e","goog.string/format","cue-list.core/app","iter__5523__auto__","s__19731","cljs.core/LazySeq","c__5521__auto__","size__5522__auto__","b__19733","cljs.core/chunk-buffer","i__19732","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__19730","cljs.core/cons","cljs.core/rest","cue-list.core/stop","cue-list.core/start","reagent.dom.render","js/document.querySelector","cue-list.core/init"],"sourcesContent":["(ns cue-list.core\n  (:require\n   [goog.object :as gobj]\n   [goog.string :as gstring]\n   [\"react\" :as react]\n   [reagent.core :as reagent]\n   [reagent.dom :as rdom]\n   )\n\n)\n\n(def ^js pdfjs (gobj/get js/window \"pdfjs-dist/build/pdf\"))\n\n\n;; TODO: create spec/schema for cue map\n;; CUE\n;; - :position  - not editable\n;; - :cue-number - editable, auto increment\n;; - :description - editable\n;; - :action - editable\n;;\n;; TODO: should cues be { \"cue-number\" { info map } }?\n\n\n;; TODO: spec out state, cues\n;;\n(defonce state (reagent/atom {:page 16\n                              :zoom 1\n                              :selected-cue-idx nil\n                              :rotate 0\n                              :cues []}))\n\n(comment\n  (reset! state {:page 16\n          :zoom 1\n          :selected-cue-idx nil\n          :rotate 0\n          :cues []})\n  (swap! state assoc :cues '[])\n  (swap! state assoc :page 16)\n  @state\n  )\n\n\n(defn dom-point-vec [point]\n  [(.-x point) (.-y point)])\n\n(defn viewport-point-to-doc-point [v-point viewport]\n  (let [trans-mat (.-transform viewport)]\n    (dom-point-vec (.transformPoint (.inverse (js/DOMMatrix. (.-transform viewport)))\n                                    (js/DOMPoint. (nth v-point 0) (nth v-point 1))))))\n\n(defn doc-point-to-view-point [doc-point viewport]\n  (dom-point-vec (.transformPoint (js/DOMMatrix. (.-transform viewport))\n                                  (js/DOMPoint. (nth doc-point 0) (nth doc-point 1)))))\n\n(defn cue-flag-points [origin]\n  [\n   origin\n   [(- (first origin) 10) (- (second origin) 10)]\n   [(- (first origin) 50) (- (second origin) 10)]\n   [(- (first origin) 50) (+ (second origin) 10)]\n   [(- (first origin) 10) (+ (second origin) 10)]\n   ]\n  )\n\n(comment\n  (swap! state assoc :cues '[])\n  (.inverse (js/DOMMatrix. (.-transform (.-viewport js/Window))))\n  (.-height (.-viewport js/Window))\n  (.-width (.-viewport js/Window))\n  (first (viewport-point-to-doc-point [0 0] (.-viewport js/Window)))\n  (last (viewport-point-to-doc-point [0 0] (.-viewport js/Window)))\n  )\n\n\n(defn on-canvas-click [event]\n  ;; translat page coordinate to doc coordinate\n  (let [rect (.getBoundingClientRect event.target)\n        vp-x (- (.-pageX event) (.-left rect))\n        vp-y (- (- (.-pageY event) (.-top rect)) (.-scrollY js/window))\n        doc-point (viewport-point-to-doc-point [vp-x vp-y] (.-viewport js/Window))\n        ;; TODO: increment cue number by finding cue number of closest position\n        last-cue (or (:cue-number (last (sort-by :cue-number (:cues @state)))) 0)\n        new-cue {:cue-number (+ 1 last-cue)\n                 :page (:page @state)\n                 :point doc-point\n                 :description \"\"\n                 :action \"\"}]\n    (swap! state assoc :cues (conj (:cues @state) new-cue))\n    (swap! state assoc :selected-cue-idx (.indexOf (:cues @state) new-cue))\n    ))\n\n(comment\n  (swap! state assoc :cues '[])\n  (.indexOf (:cues @state) (second (:cues @state)))\n  )\n\n(defn sorted-cues [cues]\n  (->>\n   cues\n   (sort-by #(first (:point %)))\n   (sort-by #(second (:point %)))\n   reverse\n   (sort-by :page)))\n\n\n(defn render-cue-flags [context viewport]\n  ;; (js/console.log (.keys js/Object viewport))\n\n    ;; rotate render context\n  (doseq [cue (filter #(= (:page %) (:page @state)) (:cues @state))]\n    (let [flag-points (cue-flag-points (doc-point-to-view-point (:point cue) viewport))\n          selected (= (:selected-cue-idx @state) (.indexOf (:cues @state) cue))\n          ]\n      (if selected\n        (set! (. context -fillStyle) \"rgba(204, 255, 110, 0.5)\")\n        (set! (. context -fillStyle) \"rgba(244, 231, 34, 0.5)\"))\n      (.beginPath context)\n      ;; draw cue\n      (.moveTo context\n               (first  (nth flag-points 0))\n               (second (nth flag-points 0)))\n      (.lineTo context\n               (first  (nth flag-points 1))\n               (second (nth flag-points 1)))\n      (.lineTo context\n               (first  (nth flag-points 2))\n               (second (nth flag-points 2)))\n      (.lineTo context\n               (first  (nth flag-points 3))\n               (second (nth flag-points 3)))\n      (.lineTo context\n               (first  (nth flag-points 4))\n               (second (nth flag-points 4)))\n      (.fill context)\n      (set! (. context -fillStyle) (if selected\n                                     \"rgba(0, 0, 0, 1)\"\n                                     \"rgba(0, 0, 0, 0.2)\"))\n      (set! (. context -font) \"25px sans-serif\")\n      (.fillText context (:cue-number cue)\n                 (first  (nth flag-points 3))\n                 (second (nth flag-points 3)))\n      )))\n\n(comment\n  (swap! state assoc :cues '[])\n  @state\n  )\n\n(defn update-doc-dims [width height]\n  (swap! state assoc :doc-dims [width height])\n  )\n\n(defn pdf-canvas [{:keys [url state]}]\n  ;; ref\n  (let [canvas-ref (react/useRef nil)]\n    ;; initialize and attach pdfjs when the canvas is mounted\n    (react/useEffect\n     (fn []\n       (do\n         (-> (.getDocument pdfjs url)\n             (.-promise)\n             (.then (fn [^js pdf] (.getPage pdf (:page state))))\n             (.then (fn [^js page]\n                      (let [viewport (.getViewport page #js {:scale (:zoom state)\n                                                             :rotation (:rotate state)})\n                            canvas (.-current canvas-ref)\n                            context (.getContext canvas \"2d\")\n                            render-context\n                            #js {:canvasContext context\n                                 :viewport viewport}]\n                        (set! canvas -height (.-height viewport))\n                        (update-doc-dims (.-width viewport) (.-height viewport))\n                        (set! canvas -width (.-width viewport))\n                        (set! (. js/Window -viewport) viewport) ;; TODO: set on state?\n                        (-> (.render page render-context)\n                            (.-promise)\n                            (.then (fn [] (js/console.log \"PDF Page rendered.\"))))\n                        )))))\n       (fn []\n         ;; not sure if there is supposed to be any cleanup for the pdfjs objects\n         ;; might need to store those somewhere and dispose of them properly here\n         ;; (js/console.log \"cleanup\")\n         ))\n     ;; ensure this only re-runs when url or nav changes\n     #js [url (:page state) (:zoom state) (:rotate state)])\n    [:canvas {:ref canvas-ref\n              :id \"document-canvas\"\n              :style {:z-index 0\n                      :position \"absolute\"}}])\n  )\n\n(defn cue-overlay [{:keys [state]}]\n  (let [canvas-ref (react/useRef nil)\n        viewport (.-viewport js/Window)\n        doc-canvas (.getElementById js/document \"document-canvas\")\n        ]\n    (react/useEffect\n     (fn []\n       (do\n         (let [\n               canvas (.-current canvas-ref)\n               context (.getContext canvas \"2d\")\n               ]\n           (do\n             (.reset context)\n             (.addEventListener canvas \"click\" on-canvas-click)\n             ;; (.reset canvas)\n             (render-cue-flags context viewport))\n           ))\n       (fn [] )) ;; (js/console.log \"cleanup\"))\n     #js [state])\n    [:canvas {:ref canvas-ref\n              :id \"overlay-canvas\"\n              :width (first (:doc-dims state))\n              :height (second (:doc-dims state))\n              :style {:position \"absolute\" :z-index 1}}])\n  )\n\n(comment\n  (js/console.log (.-viewport js/Window))\n  (.-x (.getBoundingClientRect (.getElementById js/document \"document-canvas\")))\n  (.-y (.getBoundingClientRect (.getElementById js/document \"document-canvas\")))\n  )\n\n;; UI ACTIONS\n(defn dec-page []\n  (swap! state #(update % :page dec)))\n(defn inc-page []\n  (swap! state #(update % :page inc)))\n(defn dec-zoom []\n  (swap! state #(update % :zoom (fn [i] (- i 0.25)))))\n(defn inc-zoom []\n  (swap! state #(update % :zoom (fn [i] (+ i 0.25)))))\n(defn rotate-clockwise []\n  (swap! state #(update % :rotate (fn [i] (mod (+ i 90) 360)))))\n(defn rotate-counterclockwise []\n  (swap! state #(update % :rotate (fn [i] (mod (- i 90) 360)))))\n(defn on-cue-click [cue]\n  ;; TODO: one swap\n  (swap! state assoc :page (:page cue))\n  (swap! state assoc :selected-cue-idx (.indexOf (:cues @state) cue)))\n(defn remove-cue [cue]\n  (if (= (.indexOf (:cues @state) cue) (:selected-cue-idx @state))\n    (swap! state assoc :selected-cue-idx nil)\n    )\n  (swap! state assoc :cues (vec (filter #(not= (:cue-number cue) (:cue-number %)) (:cues @state))))\n  )\n\n(comment\n  (swap! state assoc :cues '[])\n  @state\n  (:selected-cue-idx @state)\n  )\n\n(defn update-cue-field [cue kw val]\n  (let [idx (.indexOf (:cues @state) cue)]\n    (swap! state assoc :cues\n           (assoc (:cues @state) idx (assoc (nth (:cues @state) idx) kw val)))))\n(comment\n  @state\n  (update-cue-field (first (:cues @state)) :description \"test\")\n  (first (:cues @state))\n  (:selected-cue-idx @state)\n  )\n\n\n\n(defn cue-button-li [cue]\n  (if (= (.indexOf (:cues @state) cue) (:selected-cue-idx @state))\n    [:li {:style {:list-style-type \"none\"\n                  :border-style \"inset\"}}\n     [:form\n      ;; TODO on submit form, update state\n      {:on-submit #((.preventDefault %)\n                    (swap! state assoc :selected-cue-idx nil))}\n      ;;\n      [:label {:for \"cue-number\"} \"Cue Number\"]\n      [:input {:type \"text\"\n               :id \"cue-number\"\n               :name \"cue-number\"\n               :value (:cue-number cue)\n               :on-change #(update-cue-field cue :cue-number (-> % .-target .-value))}] [:label {:for \"action\"} \"Action\"]\n      [:input {:type \"text\"\n               :id \"action\"\n               :name \"action\"\n               :value (:action cue)\n               :on-change #(update-cue-field cue :action (-> % .-target .-value))\n               }]\n      [:label {:for \"description\"} \"Description\"]\n      [:input {:type \"text\"\n               :id \"description\"\n               :name \"description\"\n               :value (:description cue)\n               :on-change #(update-cue-field cue :description (-> % .-target .-value))\n               }]\n      [:input {:type \"submit\" :hidden true}]]\n     [:input {:type \"button\"\n              :on-click (fn [e] (remove-cue cue))\n              :value \"Delete Cue\"}\n      ]]\n    ;; display state\n    [:li {:style {:list-style-type \"none\"\n                  :border-style \"none\"\n                  }}\n     [:input {:type \"button\"\n              :on-click (fn [e] (on-cue-click cue))\n              :value (gstring/format \"cue: %s page: %s action: %s description: %s\"\n                                     (:cue-number cue)\n                                     (:page cue)\n                                     (:action cue)\n                                     (:description cue))}]\n     [:input {:type \"button\"\n              :on-click (fn [e] (remove-cue cue))\n              :value \"x\"}\n      ]]))\n\n;; APP\n(defn app []\n  [:div [:h1 \"Script Cue Annotator\"]\n   [:div {:id \"nav\" :style {:display \"flex\" :align-items \"flex-start\" :column-gap \"20px\"}}\n    [:div {:style {:display \"flex\" :align-items \"flex-start\" :column-gap \"5px\"}}\n     [:input {:type \"button\" :value (gstring/format \"< %s\" (dec (:page @state)))  :on-click dec-page}]\n     [:input {:type \"button\" :value (gstring/format \"> %s\" (inc (:page @state))) :on-click inc-page}]\n     [:div \"page: \" (:page @state)]]\n    [:div {:style {:display \"flex\" :align-items \"flex-start\" :column-gap \"5px\"}}\n     [:input {:type \"button\" :value \"-\" :on-click dec-zoom}]\n     [:input {:type \"button\" :value \"+\" :on-click inc-zoom}]\n     (gstring/format \"zoom: %s\" (:zoom @state))]\n    [:div {:style {:display \"flex\" :align-items \"flex-start\" :column-gap \"5px\"}}\n     \"rotate: \"\n     [:input {:type \"button\" :value \"\u21ba\" :on-click rotate-counterclockwise}]\n     [:input {:type \"button\" :value \"\u21bb\" :on-click rotate-clockwise}]\n     [:div \"rotation: \" (:rotate @state)]]]\n   [:div {:style {:display \"flex\" :align-items \"flex-start\"}}\n    [:div {:id \"canvas-container\" :style {:position \"relative\"\n                                          :flex-shrink 0\n                                          :width (first (:doc-dims @state))\n                                          :height (second (:doc-dims @state))}}\n     [:f> cue-overlay {:state @state}]\n     [:f> pdf-canvas {:url \"/test.pdf\" :state @state}] ;; TODO: only view the ux/nav state of\n     ]\n    [:div \"cues\"\n     [:ul (for [cue (sorted-cues (:cues @state))]\n            ^{:key (.indexOf (:cues @state) cue)} [cue-button-li cue])]]]])\n\n(defn ^:dev/before-load stop []\n  (js/console.log \"stop\"))\n\n(defn ^:dev/after-load start []\n  (rdom/render [app] (js/document.querySelector \"#app\"))\n  )\n\n\n(defn init []\n  (js/console.log \"starting\")\n  ;; need to tell the lib where to load the worker from, also using same CDN\n  (set! (.. pdfjs -GlobalWorkerOptions -workerSrc) \"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js\")\n  (start))\n"]}